"use strict";(self["webpackChunkkams"]=self["webpackChunkkams"]||[]).push([[47],{7863:function(t,o,s){s.d(o,{A:function(){return l}});var e=function(){var t=this,o=t._self._c;return o("div",{staticClass:"dropdown-wrapper"},[o("div",{staticClass:"dropdown",on:{click:function(o){t.isShowSelect=!t.isShowSelect}}},[o("input",{staticClass:"select-label",attrs:{type:"text",readonly:""},domProps:{value:`${t.text}`}}),t._m(0)]),o("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowSelect,expression:"isShowSelect"}],staticClass:"dropdown-menu"},t._l(t.menu,(function(s,e){return o("div",{key:e,staticClass:"select-item",on:{click:function(o){return t.selectSslFn(s)}}},[t._v(" "+t._s(`${s}`)+" ")])})),0)])},i=[function(){var t=this,o=t._self._c;return o("div",{staticClass:"icon"},[o("i",{staticClass:"el-icon-arrow-down"})])}],n={name:"dropdown",data(){return{isShowSelect:!1,text:""}},props:{menu:Array,current:String},methods:{selectSslFn(t){this.isShowSelect=!1,this.text=t,this.$emit("select",t)},close(t){this.$el.contains(t.target)||(this.isShowSelect=!1)}},watch:{current(t){this.text=t}},mounted(){this.text=this.current||this.menu[0],document.addEventListener("click",this.close)},beforeDestroy(){document.removeEventListener("click",this.close)}},a=n,r=s(1656),c=(0,r.A)(a,e,i,!1,null,null,null),l=c.exports},7047:function(t,o,s){s.r(o),s.d(o,{default:function(){return F}});var e=function(){var t=this,o=t._self._c;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"bg",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(256, 256, 256, 0.8)"}},[o("div",{staticClass:"login-container"},[t._m(0),o("div",{staticClass:"tab"},[o("div",{staticClass:"btn tab-login",class:{current:t.whichTab},on:{click:function(o){return t.changeTab("login")}}},[t._v(" 登录 ")]),o("div",{staticClass:"btn tab-register",class:{current:!t.whichTab},on:{click:function(o){return t.changeTab("register")}}},[t._v(" 配置 ")]),o("div",{staticClass:"bottom-line",class:{"line-right":!t.whichTab}})]),o("transition-group",{staticClass:"pps-e",attrs:{name:"pps-e",mode:"out-in"}},[t.whichTab?o("div",{key:"login",staticClass:"border"},[o("pps-form",{on:{submit:function(o){return t.loginFn()}}},[o("pps-input",{attrs:{clearable:"",content:t.loginForm.username,icon:"pps-icon-admin",placeholder:"用户名"},on:{"update:content":function(o){return t.$set(t.loginForm,"username",o)}}}),o("pps-input",{attrs:{clearable:"",viewPassword:"",content:t.loginForm.password,icon:"pps-icon-lock",type:"password",placeholder:"密码"},on:{"update:content":function(o){return t.$set(t.loginForm,"password",o)}}}),o("div",[o("a",{staticClass:"forget",on:{click:function(o){return t.showDialog("forget")}}},[t._v("忘记密码？")])]),o("pps-button",{staticClass:"login",attrs:{theme:"confirm"}},[t._v("登录")])],1)],1):o("div",{key:"config",staticClass:"border config"},[o("pps-form",{on:{submit:function(o){return t.submitConfigFn()},reset:function(o){return t.resetConfigFn()}}},[o("pps-input",{staticStyle:{position:"relative"},attrs:{clearable:"",content:t.configForm.host,icon:"pps-icon-host",placeholder:"无前缀后端IP地址"},on:{"update:content":function(o){return t.$set(t.configForm,"host",o)}},scopedSlots:t._u([{key:"prepend",fn:function(){return[o("dp",{attrs:{current:t.configForm.protocol,menu:["https","http"]},on:{select:t.selectSslFn}})]},proxy:!0}])}),o("pps-input",{attrs:{clearable:"",content:t.configForm.port,icon:"pps-icon-port",placeholder:"后端端口号"},on:{"update:content":function(o){return t.$set(t.configForm,"port",o)}}}),o("div",[o("p",[t._v("警告！若无需分离前后端请谨慎修改！")])]),o("div",{staticClass:"submit"},[o("pps-button",{attrs:{theme:"confirm"}},[t._v("提交")]),o("pps-button",{attrs:{theme:"",type:"reset"}},[t._v("重置")])],1)],1)],1)])],1),o("div",{staticClass:"foot"},[o("div",{staticClass:"list"}),o("div",{staticClass:"copylist"},[o("copy-icon"),t._v(" Powered by kotori ")],1)]),o("pps-dialog",{attrs:{content:t.dialogData.message,title:t.dialogData.title,show:t.isShowDialog},on:{"update:show":function(o){t.isShowDialog=o},confirmed:function(o){t.loading=!1},canceled:function(o){t.loading=!1}}})],1)},i=[function(){var t=this,o=t._self._c;return o("div",{staticClass:"logo"},[o("div",{staticClass:"login-header"},[o("img",{attrs:{src:s(3086),alt:""}}),o("div",[t._v("Kotori")])]),o("div",{staticClass:"login-desc"},[t._v("kams 是一个专为Kotori打造的后台管理界面")])])}],n=(s(4114),function(){var t=this,o=t._self._c;return o("svg",{attrs:{viewBox:"64 64 896 896",focusable:"false","data-icon":"copyright",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"}},[o("path",{attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm5.6-532.7c53 0 89 33.8 93 83.4.3 4.2 3.8 7.4 8 7.4h56.7c2.6 0 4.7-2.1 4.7-4.7 0-86.7-68.4-147.4-162.7-147.4C407.4 290 344 364.2 344 486.8v52.3C344 660.8 407.4 734 517.3 734c94 0 162.7-58.8 162.7-141.4 0-2.6-2.1-4.7-4.7-4.7h-56.8c-4.2 0-7.6 3.2-8 7.3-4.2 46.1-40.1 77.8-93 77.8-65.3 0-102.1-47.9-102.1-133.6v-52.6c.1-87 37-135.5 102.2-135.5z"}})])}),a=[],r={name:"copyIcon"},c=r,l=s(1656),p=(0,l.A)(c,n,a,!1,null,null,null),h=p.exports,d=s(1552),u=s(3518),m=s(7863),g=s(5563),f={name:"myLogin",components:{copyIcon:h,dp:m.A},data(){return{t:"",tabsFlag:"login",isShowDialog:!1,loading:!1,isShowSelect:!1,dialogData:{},loginForm:{username:"",password:""},configForm:{protocol:"https",host:"",port:""}}},methods:{...(0,u.PY)("layoutOption",["updateToken","updateHost","updatePort","updateProtocol","updateUsername","updatePassword"]),changeTab(t){this.tabsFlag=t},selectSslFn(t){this.configForm.protocol=t},submitConfigFn(){const t={host:this.configForm.host,port:this.configForm.port,protocol:this.configForm.protocol,username:this.loginForm.username,password:this.loginForm.password};(0,g.Dh)({configData:t})},resetConfigFn(){this.configForm.host=this.host,this.configForm.port=this.port,this.configForm.protocol=this.protocol,this.$message.info("已重置！")},async loginFn(){this.loading=!0;try{const{data:t}=await(0,d.MI)(this.loginForm);t.token&&(this.updateToken(t.token),this.updateUsername(this.loginForm.username),this.updatePassword(this.loginForm.password),this.loading=!1,this.$router.push("/"))}catch(t){if(this.loading=!1,404===t.response.status)return this.showDialog("404");if(401===t.response.status)return this.showDialog("401");console.log(t),this.$dialog({title:"错误",content:t.message}).catch((t=>{}))}},showDialog(t,o){this.dialogData=t&&"forget"===t?{title:"提示",message:"暂未开放！"}:t&&"401"===t?{title:"警告",message:"账号或密码不正确！"}:t&&"404"===t?{title:"警告",message:"请求资源不存在！检查后端服务是否正常！"}:{title:"警告",message:o},this.isShowDialog=!0}},computed:{...(0,u.aH)("layoutOption",["host","port","protocol","username","password","sandBoxPort"]),whichTab(){return"login"===this.tabsFlag}},watch:{host:{handler(t,o){this.configForm.host=t},immediate:!0},port:{handler(t,o){this.configForm.port=t},immediate:!0},protocol:{handler(t,o){this.configForm.protocol=t},immediate:!0},username:{handler(t,o){this.loginForm.username=t},immediate:!0},password:{handler(t,o){this.loginForm.password=t},immediate:!0}},mounted(){},created(){this.configForm.protocol=this.protocol||"https://"}},v=f,w=(0,l.A)(v,e,i,!1,null,"87e9a05c",null),F=w.exports},3086:function(t,o,s){t.exports=s.p+"img/favicon.b107f5c1.svg"}}]);
//# sourceMappingURL=47.b880ff7d.js.map